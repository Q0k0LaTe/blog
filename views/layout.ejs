<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <!-- Fixed CSS path -->
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        /* Fallback styles in case external CSS doesn't load */
        body { 
            font-family: 'EB Garamond', Georgia, serif; 
            line-height: 1.7; 
            margin: 0; 
            padding: 0; 
            color: #2d2d2d;
            background: #fefefe;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 20px; 
        }
        .header { 
            background: #f8f6f0; 
            border-bottom: 3px solid #d4af37;
            padding: 3rem 0 2rem; 
        }
        .header h1 {
            color: #1a1a1a;
            font-size: 3rem;
            margin-bottom: 0.5rem;
            text-align: center;
            font-weight: 400;
        }
        .card { 
            background: white; 
            padding: 2.5rem; 
            margin: 2rem 0; 
            border-radius: 2px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid rgba(212, 175, 55, 0.1);
        }
    </style>
    
    <!-- MathJax Configuration -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <header class="header">
        <div class="container">
            <h1>Life & Mathematics</h1>
            <p>Exploring the beautiful intersection of mathematical thinking and human experience</p>
            <nav class="nav">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/blog">Blog</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <%- body %>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; <%= new Date().getFullYear() %> Life & Mathematics. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Re-render MathJax after page load -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Page loaded, initializing MathJax...');
            
            // Re-render MathJax
            if (window.MathJax) {
                MathJax.typesetPromise().then(() => {
                    console.log('‚úì MathJax rendered successfully');
                }).catch((err) => {
                    console.error('‚ùå MathJax error:', err);
                });
            } else {
                console.warn('‚ö†Ô∏è MathJax not available');
            }
            
            // Log TikZ images found (server-side rendered)
            const tikzImages = document.querySelectorAll('.tikz-image');
            console.log(`‚úì Found ${tikzImages.length} server-rendered TikZ diagrams`);
        });
    </script>
</body>
</html>